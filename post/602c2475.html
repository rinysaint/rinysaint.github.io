
<!DOCTYPE html>
<html lang="zh-Hans" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>群晖+公网ip+阿里云ddns解析，完美外网访问 - 萧日宁的世界</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta http-equiv="Access-Control-Allow-Origin" content="*" />
    <meta name="keywords" content="萧日宁,肖日宁,君子兰,人工智能,AI,机器学习,博客,大数据,微服务,xiaorining,kingslanding,ddns,群晖,公网ip,阿里云,外网访问"> 
    <meta name="description" content="萧日宁,肖日宁,君子兰,人工智能,AI,机器学习,博客,大数据,微服务,xiaorining,kingslanding,前言上回说到，通过公网IP，我们已经能使用 ip:端口 的方式，在外网访问到，我们的群晖nas了。
但是面临着两个问题。第一点，公网ip复杂难记，就是你勉强记住了，熟悉了，第二点，ip是会变化的。
,"> 
    <meta name="author" content="萧日宁"> 
    <link rel="alternative" href="atom.xml" title="萧日宁的世界" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    
    
<link rel="stylesheet" href="/css/diaspora.css">
<link rel="stylesheet" href="/css/APlayer.min.css">

<meta name="generator" content="Hexo 6.3.0"></head>

<body class="loading">
    <span id="config-title" style="display:none">萧日宁的世界</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="iconfont icon-home image-icon" href="javascript:;" data-url="https://blog.aichn.cn"></a>
        <!-- page音乐插件 -->
        
    <h3 class="subtitle">群晖+公网ip+阿里云ddns解析，完美外网访问</h3>
    <div class="social">
        <div>
            <div class="share">
                <a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">群晖+公网ip+阿里云ddns解析，完美外网访问</h1>
        <div class="stuff">
            <span>十二月 23, 2018</span>
            
  <ul class="post-tags-list" itemprop="keywords"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/ddns/" rel="tag">ddns</a></li></ul>


        </div>
        <div class="content markdown">
            <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a><strong>前言</strong></h3><p>上回说到，通过公网IP，我们已经能使用 ip:端口 的方式，在外网访问到，我们的群晖nas了。</p>
<p>但是面临着两个问题。第一点，公网ip复杂难记，就是你勉强记住了，熟悉了，第二点，ip是会变化的。</p>
<p>这就很难受了。</p>
<p>有没有什么好的解决方案。</p>
<p>答案自然是有的——DDNS。</p>
<h3 id="什么是DDNS"><a href="#什么是DDNS" class="headerlink" title="什么是DDNS"></a><strong>什么是DDNS</strong></h3><p>参考百度百科。</p>
<blockquote>
<p>DDNS（Dynamic Domain Name Server，动态域名服务）是将用户的动态IP地址映射到一个固定的域名解析服务上，用户每次连接网络的时候客户端程序就会通过信息传递把该主机的动态IP地址传送给位于服务商主机上的服务器程序，服务器程序负责提供DNS服务并实现动态域名解析。</p>
</blockquote>
<p>这东西听起来就很符合我们的需求。</p>
<p>开搞。</p>
<h3 id="准备"><a href="#准备" class="headerlink" title="准备"></a><strong>准备</strong></h3><p>其实群晖自带也是有DDNS的设置的。在，控制面板-外部访问-DDNS中。</p>
<p><img src="/../images/%E7%BE%A4%E6%99%96+%E5%85%AC%E7%BD%91ip+%E9%98%BF%E9%87%8C%E4%BA%91ddns%E8%A7%A3%E6%9E%90%EF%BC%8C%E5%AE%8C%E7%BE%8E%E5%A4%96%E7%BD%91%E8%AE%BF%E9%97%AE/v2-ca7f7c4df3126d2b21d696cddbd733dc_720w.jpg" alt="img"></p>
<p>其实，可以申请群晖自己的服务，包括域名那些。</p>
<p>好像是可以免费的。（没折腾过，不清楚，回头试试）</p>
<p>可是我为啥还是选择阿里云。</p>
<ol>
<li>机子支持docker，想玩。（别问我为啥需要docker，因为群晖ddns的设置里面，服务商没有阿里云的）</li>
<li>我自己有阿里云服务器；</li>
<li>我已经有备案好的自己的域名了。</li>
</ol>
<p>如果你也想加入阿里云。可以看看这里。双十二还有活动。</p>
<p><a href="https://link.zhihu.com/?target=https://www.aliyun.com/minisite/goods?userCode=zyatgdr1&taskCode=pintuan20201212&recordId=305304">优惠上云，来阿里云·云小站www.aliyun.com/minisite/goods?userCode=zyatgdr1&taskCode=pintuan20201212&recordId=305304<img src="https://pic1.zhimg.com/v2-8d9075848f13871f324bab0db4eb7628_ipico.jpg" alt="img"></a></p>
<p>如果你也具备这些条件，那就继续往下看。</p>
<h3 id="阿里云设置"><a href="#阿里云设置" class="headerlink" title="阿里云设置"></a><strong>阿里云设置</strong></h3><h3 id="1-登录阿里云控制台，鼠标右上角头像，找到-“accesskey管理”"><a href="#1-登录阿里云控制台，鼠标右上角头像，找到-“accesskey管理”" class="headerlink" title="1. 登录阿里云控制台，鼠标右上角头像，找到 “accesskey管理”"></a><strong>1. 登录阿里云控制台，鼠标右上角头像，找到 “accesskey管理”</strong></h3><p><img src="/../images/%E7%BE%A4%E6%99%96+%E5%85%AC%E7%BD%91ip+%E9%98%BF%E9%87%8C%E4%BA%91ddns%E8%A7%A3%E6%9E%90%EF%BC%8C%E5%AE%8C%E7%BE%8E%E5%A4%96%E7%BD%91%E8%AE%BF%E9%97%AE/v2-5bebd9022932f48f9ab3452d7f6a596a_720w.jpg" alt="img"></p>
<h3 id="2-进去之后选择使用子账号Accesskey"><a href="#2-进去之后选择使用子账号Accesskey" class="headerlink" title="2. 进去之后选择使用子账号Accesskey"></a><strong>2. 进去之后选择使用子账号Accesskey</strong></h3><p>因为就是说，好管理，权限分配的比较明确。这一块，比较推荐这么做。</p>
<p>创建好账号，授权</p>
<h3 id="3-权限管理-授权"><a href="#3-权限管理-授权" class="headerlink" title="3. 权限管理-授权"></a><strong>3. 权限管理-授权</strong></h3><p>选择就是 <strong>管理云解析（DNS）的权限</strong></p>
<p>注意是<strong>管理</strong>！</p>
<h3 id="4-将账号的-AccessKeyID、AccessKeySecret-保存下来"><a href="#4-将账号的-AccessKeyID、AccessKeySecret-保存下来" class="headerlink" title="4. 将账号的 AccessKeyID、AccessKeySecret 保存下来"></a><strong>4. 将账号的 AccessKeyID、AccessKeySecret 保存下来</strong></h3><p>有个选择，可以选择下载下来的。</p>
<p>这样不容易忘记。</p>
<p>保存这两个，极其重要。</p>
<h3 id="域名设置"><a href="#域名设置" class="headerlink" title="域名设置"></a><strong>域名设置</strong></h3><p>还是在阿里云的控制台，选择就是找到域名解析。</p>
<p><img src="/../images/%E7%BE%A4%E6%99%96+%E5%85%AC%E7%BD%91ip+%E9%98%BF%E9%87%8C%E4%BA%91ddns%E8%A7%A3%E6%9E%90%EF%BC%8C%E5%AE%8C%E7%BE%8E%E5%A4%96%E7%BD%91%E8%AE%BF%E9%97%AE/v2-16e22c6683ebed48cb51c4af090d9644_720w.jpg" alt="img"></p>
<p>点击<strong>“域名”</strong>，进去找到就是域名解析。</p>
<p>对自己已经备好案的域名，进行解析的设置。</p>
<p>选择添加记录。</p>
<p><img src="/../images/%E7%BE%A4%E6%99%96+%E5%85%AC%E7%BD%91ip+%E9%98%BF%E9%87%8C%E4%BA%91ddns%E8%A7%A3%E6%9E%90%EF%BC%8C%E5%AE%8C%E7%BE%8E%E5%A4%96%E7%BD%91%E8%AE%BF%E9%97%AE/v2-396eddb9ac921a9012448767cc3a0f4a_720w.jpg" alt="img"></p>
<p>选择类型A-将域名指向一个ipv4地址，</p>
<p>主机记录，补充完整自己的域名。（这个完整的域名下面要用到）</p>
<p>记录值，选择你家的公网ip。</p>
<h3 id="docker跑起来"><a href="#docker跑起来" class="headerlink" title="docker跑起来"></a><strong>docker跑起来</strong></h3><h3 id="1-套件中心下载docker，安装"><a href="#1-套件中心下载docker，安装" class="headerlink" title="1. 套件中心下载docker，安装"></a><strong>1. 套件中心下载docker，安装</strong></h3><h3 id="2-在注册表中，搜索-“aliyun-ddns”，此处我用的第一个"><a href="#2-在注册表中，搜索-“aliyun-ddns”，此处我用的第一个" class="headerlink" title="2. 在注册表中，搜索 “aliyun-ddns”，此处我用的第一个"></a><strong>2. 在注册表中，搜索 “aliyun-ddns”，此处我用的第一个</strong></h3><p><img src="/../images/%E7%BE%A4%E6%99%96+%E5%85%AC%E7%BD%91ip+%E9%98%BF%E9%87%8C%E4%BA%91ddns%E8%A7%A3%E6%9E%90%EF%BC%8C%E5%AE%8C%E7%BE%8E%E5%A4%96%E7%BD%91%E8%AE%BF%E9%97%AE/v2-d7cf6ec1f74f3a6a06778c83481e2e83_720w.jpg" alt="img"></p>
<h3 id="3-右键下载安装"><a href="#3-右键下载安装" class="headerlink" title="3. 右键下载安装"></a><strong>3. 右键下载安装</strong></h3><p>如果你下载不了，可能docker需要设置一下。 这个在我折腾<strong>jellyfin</strong> 的时候，就体验到了。</p>
<p>如果docker下载速度慢，或者失败，你可能需要设置下docker镜像。</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/337825636">卡尺：第六篇：群晖docker加速镜像下载5 赞同 · 6 评论文章<img src="/../images/%E7%BE%A4%E6%99%96+%E5%85%AC%E7%BD%91ip+%E9%98%BF%E9%87%8C%E4%BA%91ddns%E8%A7%A3%E6%9E%90%EF%BC%8C%E5%AE%8C%E7%BE%8E%E5%A4%96%E7%BD%91%E8%AE%BF%E9%97%AE/v2-a52a73c2cdf8b6885fee7c5badb2597f_180x120.jpg" alt="img"></a></p>
<p>关于一个是jellyfin的教程。</p>
<h3 id="4-等待下载完成，你可以在“映像”中看到"><a href="#4-等待下载完成，你可以在“映像”中看到" class="headerlink" title="4. 等待下载完成，你可以在“映像”中看到"></a><strong>4. 等待下载完成，你可以在“映像”中看到</strong></h3><p><img src="/../images/%E7%BE%A4%E6%99%96+%E5%85%AC%E7%BD%91ip+%E9%98%BF%E9%87%8C%E4%BA%91ddns%E8%A7%A3%E6%9E%90%EF%BC%8C%E5%AE%8C%E7%BE%8E%E5%A4%96%E7%BD%91%E8%AE%BF%E9%97%AE/v2-b2d1eee22eeb7c2ada129cbc178dea04_720w.jpg" alt="img"></p>
<h3 id="5-选中，左上角的“启动”，打开设置向导"><a href="#5-选中，左上角的“启动”，打开设置向导" class="headerlink" title="5. 选中，左上角的“启动”，打开设置向导"></a><strong>5. 选中，左上角的“启动”，打开设置向导</strong></h3><p>在<strong>”高级设置“</strong>中，选择“<strong>环境</strong>“ ，对应关系</p>
<p>AKID 对应 刚刚保存下来的 AccessKeyID</p>
<p>AKSCT 对应 AccessKeySecret</p>
<p>DOMAIN 对应 （刚刚的完整的）你的域名</p>
<h3 id="6-应用，启动，"><a href="#6-应用，启动，" class="headerlink" title="6. 应用，启动，"></a><strong>6. 应用，启动，</strong></h3><p>在容器选择你启动的ddns，右键详情，在日志里面找到解析记录的话，就是成功了。</p>
<h3 id="如何访问"><a href="#如何访问" class="headerlink" title="如何访问"></a><strong>如何访问</strong></h3><p>当上面都弄好了。你可以通过 域名加端口的方式，访问到你的群晖了。举个栗子。</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">home.xxxx.xyz:5000</span><br></pre></td></tr></table></figure>



<p>至此，外网访问总算是完美了。</p>
<hr>
<p>希望对你有帮助。</p>
<hr>
<p><strong>2020&#x2F;12&#x2F;18 补充更新</strong></p>
<p>早上看到阿里云半夜给我发邮件。说是记录值修改了。</p>
<p><img src="/../images/%E7%BE%A4%E6%99%96+%E5%85%AC%E7%BD%91ip+%E9%98%BF%E9%87%8C%E4%BA%91ddns%E8%A7%A3%E6%9E%90%EF%BC%8C%E5%AE%8C%E7%BE%8E%E5%A4%96%E7%BD%91%E8%AE%BF%E9%97%AE/v2-5153f98826647a28ea12dfa4bf647515_720w.jpg" alt="img"></p>
<p>可以证明我们的设置没有问题。当公网ip变化的时候，docker的程序能发现这一变化，然后因为有云解析的权限，去修改了这个记录值，保证我们能通过一直通过域名访问到我的群晖啦。</p>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                </ul>
            
        </div>
        
    <div id='gitalk-container' class="comment link"
		data-enable='false'
        data-ae='false'
        data-ci=''
        data-cs=''
        data-r=''
        data-o=''
        data-a=''
        data-d='false'
    >查看评论</div>


    </div>
    
        <div class='side'>
			<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFDDNS"><span class="toc-number">2.</span> <span class="toc-text">什么是DDNS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%86%E5%A4%87"><span class="toc-number">3.</span> <span class="toc-text">准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%BF%E9%87%8C%E4%BA%91%E8%AE%BE%E7%BD%AE"><span class="toc-number">4.</span> <span class="toc-text">阿里云设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%99%BB%E5%BD%95%E9%98%BF%E9%87%8C%E4%BA%91%E6%8E%A7%E5%88%B6%E5%8F%B0%EF%BC%8C%E9%BC%A0%E6%A0%87%E5%8F%B3%E4%B8%8A%E8%A7%92%E5%A4%B4%E5%83%8F%EF%BC%8C%E6%89%BE%E5%88%B0-%E2%80%9Caccesskey%E7%AE%A1%E7%90%86%E2%80%9D"><span class="toc-number">5.</span> <span class="toc-text">1. 登录阿里云控制台，鼠标右上角头像，找到 “accesskey管理”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%BF%9B%E5%8E%BB%E4%B9%8B%E5%90%8E%E9%80%89%E6%8B%A9%E4%BD%BF%E7%94%A8%E5%AD%90%E8%B4%A6%E5%8F%B7Accesskey"><span class="toc-number">6.</span> <span class="toc-text">2. 进去之后选择使用子账号Accesskey</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86-%E6%8E%88%E6%9D%83"><span class="toc-number">7.</span> <span class="toc-text">3. 权限管理-授权</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%B0%86%E8%B4%A6%E5%8F%B7%E7%9A%84-AccessKeyID%E3%80%81AccessKeySecret-%E4%BF%9D%E5%AD%98%E4%B8%8B%E6%9D%A5"><span class="toc-number">8.</span> <span class="toc-text">4. 将账号的 AccessKeyID、AccessKeySecret 保存下来</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%9F%E5%90%8D%E8%AE%BE%E7%BD%AE"><span class="toc-number">9.</span> <span class="toc-text">域名设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker%E8%B7%91%E8%B5%B7%E6%9D%A5"><span class="toc-number">10.</span> <span class="toc-text">docker跑起来</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%A5%97%E4%BB%B6%E4%B8%AD%E5%BF%83%E4%B8%8B%E8%BD%BDdocker%EF%BC%8C%E5%AE%89%E8%A3%85"><span class="toc-number">11.</span> <span class="toc-text">1. 套件中心下载docker，安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%9C%A8%E6%B3%A8%E5%86%8C%E8%A1%A8%E4%B8%AD%EF%BC%8C%E6%90%9C%E7%B4%A2-%E2%80%9Caliyun-ddns%E2%80%9D%EF%BC%8C%E6%AD%A4%E5%A4%84%E6%88%91%E7%94%A8%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA"><span class="toc-number">12.</span> <span class="toc-text">2. 在注册表中，搜索 “aliyun-ddns”，此处我用的第一个</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8F%B3%E9%94%AE%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85"><span class="toc-number">13.</span> <span class="toc-text">3. 右键下载安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%AD%89%E5%BE%85%E4%B8%8B%E8%BD%BD%E5%AE%8C%E6%88%90%EF%BC%8C%E4%BD%A0%E5%8F%AF%E4%BB%A5%E5%9C%A8%E2%80%9C%E6%98%A0%E5%83%8F%E2%80%9D%E4%B8%AD%E7%9C%8B%E5%88%B0"><span class="toc-number">14.</span> <span class="toc-text">4. 等待下载完成，你可以在“映像”中看到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E9%80%89%E4%B8%AD%EF%BC%8C%E5%B7%A6%E4%B8%8A%E8%A7%92%E7%9A%84%E2%80%9C%E5%90%AF%E5%8A%A8%E2%80%9D%EF%BC%8C%E6%89%93%E5%BC%80%E8%AE%BE%E7%BD%AE%E5%90%91%E5%AF%BC"><span class="toc-number">15.</span> <span class="toc-text">5. 选中，左上角的“启动”，打开设置向导</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%BA%94%E7%94%A8%EF%BC%8C%E5%90%AF%E5%8A%A8%EF%BC%8C"><span class="toc-number">16.</span> <span class="toc-text">6. 应用，启动，</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E8%AE%BF%E9%97%AE"><span class="toc-number">17.</span> <span class="toc-text">如何访问</span></a></li></ol>	
        </div>
    
</div>


    </div>
</div>
</body>


<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/typed.js"></script>
<script src="/js/diaspora.js"></script>


<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">


<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>




</html>
